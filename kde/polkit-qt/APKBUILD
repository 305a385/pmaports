# Contributor: Bart Ribbers <bribbers@disroot.org>
# Maintainer: Bart Ribbers <bribbers@disroot.org>
pkgname=polkit-qt
_pkgname=polkit-qt-1
pkgver=0.112.0_git20190402
pkgrel=0
_commit="f26ada834aeac7207d36744d49c16ed43996f471"
pkgdesc="Qt wrapper around polkit-1 client libraries, used by kdelibs to provide the polkit-1 kauth backend and by KDE's polkit client"
arch="all"
url="https://www.kde.org"
license="LGPL-2.1"
depends="polkit"
depends_dev="qt5-qtbase-dev"
makedepends="$depends_dev cmake automoc4 polkit-dev"
source="$pkgname-$_commit.tar.gz::https://github.com/kde/$_pkgname/archive/$_commit.tar.gz"
subpackages="$pkgname-dev $pkgname-dev"
builddir="$srcdir/$_pkgname-$_commit"

build() {
	cd "$builddir"
	cmake \
		-DCMAKE_BUILD_TYPE=RelWithDebugInfo \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib
	make
}

check() {
	cd "$builddir"
	CTEST_OUTPUT_ON_FAILURE=TRUE ctest
}

package() {
	cd "$builddir"
	DESTDIR="$pkgdir" make install
}
sha512sums="41384cc46cba8f4f34122c1846a65191d87cf2ea8d082c401ab21baf865aadbdc6421d97e3137939890be586faa1135df8d65756f2724494665a36963317a2a4  polkit-qt-f26ada834aeac7207d36744d49c16ed43996f471.tar.gz"
